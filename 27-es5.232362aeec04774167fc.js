function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var c=e[n];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(t,c.key,c)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{"8roW":function(t,e,n){"use strict";n.r(e),n.d(e,"CatalogwebPageModule",(function(){return M}));var c=n("ofXK"),o=n("3Pt+"),i=n("TEn/"),a=n("tyNb"),r=n("LRne"),s=n("q3Kh"),l=n("pwB6"),u=n("JIr8"),d=n("un/a"),h=n("fXoL"),g=n("gren"),p=n("tk/3"),b=n("1jcm"),f=n("hV0v"),v=n("sYmb");function m(t,e){1&t&&h.cc(0,"ion-progress-bar",8)}function y(t,e){if(1&t){var n=h.ic();h.hc(0,"ion-item"),h.hc(1,"mat-slide-toggle",9),h.pc("ngModelChange",(function(t){return h.Nc(n),h.tc().saveonlytoglobal=t})),h.Xc(2),h.uc(3,"translate"),h.gc(),h.gc()}if(2&t){var c=h.tc();h.Ob(1),h.Cc("ngModel",c.saveonlytoglobal),h.Ob(1),h.Zc("",h.vc(3,2,"Save only to Global")," ")}}function k(t,e){1&t&&(h.hc(0,"div"),h.Xc(1),h.uc(2,"translate"),h.gc()),2&t&&(h.Ob(1),h.Zc(" ",h.vc(2,1,"No Product Found")," "))}function w(t,e){if(1&t){var n=h.ic();h.hc(0,"app-productcard-grandbazar",12),h.pc("actionevent",(function(t){return h.Nc(n),h.tc(3).perform(t)})),h.gc()}if(2&t){var c=e.$implicit,o=h.tc(3);h.Cc("product",c)("webcatalogupload",!0)("productlist",o.crudList)("onpage","catalogweb")}}function C(t,e){if(1&t&&(h.hc(0,"div"),h.Vc(1,k,3,3,"div",5),h.Vc(2,w,1,4,"app-productcard-grandbazar",11),h.gc()),2&t){var n=e.ngIf,c=h.tc(2);h.Ob(1),h.Cc("ngIf",0==n.length),h.Ob(1),h.Cc("ngForOf",c.processlist(n,c.whatsize))}}function O(t,e){if(1&t&&(h.hc(0,"div",10),h.Vc(1,C,3,2,"div",5),h.uc(2,"searchproducts"),h.gc()),2&t){var n=h.tc(),c=h.Kc(9);h.Ob(1),h.Cc("ngIf",h.xc(2,1,n.productlist,n.searchstring,c.value))}}function I(t,e){if(1&t){var n=h.ic();h.hc(0,"ion-infinite-scroll",13),h.pc("ionInfinite",(function(t){return h.Nc(n),h.tc().loadData(t)})),h.cc(1,"ion-infinite-scroll-content",14),h.uc(2,"translate"),h.gc()}2&t&&(h.Ob(1),h.Dc("loadingText",h.vc(2,1,"Loading more data...")))}var P,S,j,x=[{path:"",component:(P=function(){function t(e,n,c,o,i,a){_classCallCheck(this,t),this.ngxUiLoaderService=e,this.alertme=n,this.http=c,this.centerdb=o,this.ydata=i,this.ygen=a,this.addItemList=[],this.productlistcount=0,this.totalproducts=0,this.showscroll=!1,this.productlimit=50,this.saveonlytoglobal=!1,this.whatsize=50,this.queryText="",this.searchstring="{}"}return _createClass(t,[{key:"ngOnInit",value:function(){var t=this;this.centerdb.currenttenant.subscribe((function(e){e&&(t.crudList=new l.p(l.P.getpath()+"/shop/products",t.ydata.getDatabase(),!0,t.ygen.getUid()),t.crudList.getList().subscribe((function(e){t.productlimit=e.length})))})),this.ngxUiLoaderService.start(),this.centerdb.currenttenant.subscribe((function(e){t.crudList=new l.p(l.P.getpath()+"/shop/products",t.ydata.getDatabase(),!0,t.ygen.getUid())})),this.webcatalogs=this.http.get("https://bandhanmaratha.firebaseio.com/catalogmaster.json").pipe(Object(s.map)((function(e){return t.productlistcount=Object.keys(e).length,t.showscroll=!0,Object.keys(e).map((function(t){return Object.assign({maxqty:10,key:t},e[t])}))})),Object(u.a)((function(e){return t.alertme.errordata("Error Retriving the Web Catalog From Remote Server...Please refresh.."),t.ngxUiLoaderService.stop(),Object(r.a)([])})),Object(d.a)(2)),this.webcatalogs.subscribe((function(e){t.productlist=e,t.ngxUiLoaderService.stop()}))}},{key:"addtolist",value:function(t){this.addItemList.push(t)}},{key:"processlist",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50;return t.length<e&&(e=t.length),t.slice(0,e)}},{key:"loadData",value:function(t){var e=this;setTimeout((function(){console.log("Done"),t.target.complete(),e.whatsize>=e.productlistcount?t.target.disabled=!0:(t.target.disabled=!1,e.whatsize=e.whatsize+50)}),500)}},{key:"trimObjValues",value:function(t){return Object.keys(t).reduce((function(e,n){return e[n]="string"==typeof t[n]?t[n].trim():t[n],e}),{})}},{key:"saveItem",value:function(t){var e=(t=this.trimObjValues(t)).key;delete t.key,this.saveonlytoglobal||(this.ygen.canAddProducts()?this.crudList.addtolist(t):this.alertme.openSnackBar("Reach ".concat(this.productlimit," maxlimit of Products will not be added"),"OK")),this.globalsave(t,e)}},{key:"globalsave",value:function(t,e){e&&e.length>0&&this.ygen.isSuperAdmin()&&this.http.put("https://bandhanmaratha.firebaseio.com/catalogmaster/"+e+".json",t).subscribe((function(t){}))}},{key:"globaldelete",value:function(t,e){e&&e.length>0&&this.ygen.isSuperAdmin()&&this.http.delete("https://bandhanmaratha.firebaseio.com/catalogmaster/"+e+".json").subscribe((function(t){}))}},{key:"perform",value:function(t){switch(t.what){case"add":t.event.discount=this.getDiscount(t.event),this.saveItem(t.event),this.productlist=this.productlist.filter((function(e){return e.key!=t.event.key})),this.alertme.openSnackBar("Product Added to Your Catalog","Ok");break;case"delete":this.productlist=this.productlist.filter((function(e){return e.key!=t.event.key})),this.alertme.openSnackBar("Product deleted","Ok");break;case"deletex":this.productlist=this.productlist.filter((function(e){return e.key!=t.event.key})),this.globaldelete(t.event,t.event.key),this.alertme.openSnackBar("Product deleted","Ok");break;case"copy":t.event.discount=this.getDiscount(t.event),this.productlist.push(t.event),this.alertme.openSnackBar("Product copied","Ok")}}},{key:"getDiscount",value:function(t){var e=t.mrp?t.mrp:200;return(100*(e-(t.price?t.price:100))/e).toFixed(0)}},{key:"getItems",value:function(t){console.log(t)}},{key:"setSearchedProducts",value:function(t){this.totalproducts=t.length}}]),t}(),P.\u0275fac=function(t){return new(t||P)(h.bc(g.c),h.bc(l.a),h.bc(p.b),h.bc(l.P),h.bc(l.Q),h.bc(l.T))},P.\u0275cmp=h.Vb({type:P,selectors:[["app-catalogweb"]],decls:20,vars:17,consts:[[3,"color"],["slot","start"],["debounce","100",3,"placeholder","ngModel","ionChange","ngModelChange"],["mySearchbar",""],["loading",""],[4,"ngIf"],["class","productlist",4,"ngIf","ngIfElse"],["threshold","100px",3,"ionInfinite",4,"ngIf"],["type"," indeterminate","reversed","true"],[3,"ngModel","ngModelChange"],[1,"productlist"],[3,"product","webcatalogupload","productlist","onpage","actionevent",4,"ngFor","ngForOf"],[3,"product","webcatalogupload","productlist","onpage","actionevent"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles",3,"loadingText"]],template:function(t,e){if(1&t&&(h.hc(0,"ion-header"),h.hc(1,"ion-toolbar",0),h.hc(2,"ion-buttons",1),h.cc(3,"ion-back-button"),h.gc(),h.hc(4,"ion-title"),h.Xc(5),h.uc(6,"translate"),h.gc(),h.gc(),h.hc(7,"ion-toolbar",0),h.hc(8,"ion-searchbar",2,3),h.pc("ionChange",(function(t){return e.getItems(t)}))("ngModelChange",(function(t){return e.queryText=t})),h.uc(10,"translate"),h.gc(),h.gc(),h.gc(),h.hc(11,"ion-content"),h.Vc(12,m,1,0,"ng-template",null,4,h.Wc),h.hc(14,"ion-item"),h.Xc(15),h.gc(),h.Vc(16,y,4,4,"ion-item",5),h.Vc(17,O,3,5,"div",6),h.uc(18,"async"),h.Vc(19,I,3,3,"ion-infinite-scroll",7),h.gc()),2&t){var n=h.Kc(13);h.Ob(1),h.Cc("color","warning"),h.Ob(4),h.Yc(h.vc(6,11,"Web Catalog")),h.Ob(2),h.Cc("color","warning"),h.Ob(1),h.Dc("placeholder",h.vc(10,13,"Search Products")),h.Cc("ngModel",e.queryText),h.Ob(7),h.ad(' You are using "',e.ygen.getSubscriptionType(),'" subscription; You can add max ',e.ygen.maxproductsCanAdded()," products; "),h.Ob(1),h.Cc("ngIf",e.ygen.isSuperAdmin()),h.Ob(1),h.Cc("ngIf",h.vc(18,15,e.webcatalogs))("ngIfElse",n),h.Ob(2),h.Cc("ngIf",e.showscroll)}},directives:[i.y,i.hb,i.j,i.f,i.g,i.fb,i.S,i.ub,o.p,o.s,i.s,i.D,c.m,i.P,b.a,c.l,f.a,i.A,i.B],pipes:[v.c,c.b,l.F],styles:[".productCardSection[_ngcontent-%COMP%]{white-space:nowrap;height:auto;overflow-X:scroll;overflow-y:hidden}.mytopsaver[_ngcontent-%COMP%]{display:flex}"]}),P)}],L=((S=function t(){_classCallCheck(this,t)}).\u0275mod=h.Zb({type:S}),S.\u0275inj=h.Yb({factory:function(t){return new(t||S)},imports:[[a.n.forChild(x)],a.n]}),S),D=n("uUdd"),M=((j=function t(){_classCallCheck(this,t)}).\u0275mod=h.Zb({type:j}),j.\u0275inj=h.Yb({factory:function(t){return new(t||j)},imports:[[c.c,o.j,i.ib,l.H,l.o,l.b,D.a,L]]}),j)}}]);