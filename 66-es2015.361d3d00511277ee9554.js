(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{oRaJ:function(t,c,e){"use strict";e.r(c),e.d(c,"UploadbrandsPageModule",(function(){return w}));var i=e("ofXK"),n=e("3Pt+"),o=e("TEn/"),a=e("tyNb"),s=e("pwB6"),r=e("DVUX"),l=e("fXoL"),d=e("P6Fj"),p=e("7pIB"),u=e("NFeN");function h(t,c){if(1&t){const t=l.ic();l.hc(0,"div"),l.hc(1,"input",7,8),l.pc("change",(function(c){return l.Nc(t),l.tc().previewFile(c)})),l.gc(),l.hc(3,"button",9),l.pc("click",(function(){return l.Nc(t),l.Kc(2).click()})),l.hc(4,"mat-icon",10),l.Xc(5,"extension"),l.gc(),l.Xc(6," Add Products Brands "),l.gc(),l.gc()}if(2&t){const t=l.tc();l.Ob(1),l.Cc("uploader",t.uploader)}}function g(t,c){if(1&t){const t=l.ic();l.hc(0,"div",11),l.hc(1,"button",12),l.pc("click",(function(){return l.Nc(t),l.tc().clearAllItems()})),l.hc(2,"mat-icon",10),l.Xc(3,"delete"),l.gc(),l.Xc(4," Clear All Brands "),l.gc(),l.hc(5,"button",9),l.pc("click",(function(){return l.Nc(t),l.tc().saveAllItems()})),l.hc(6,"mat-icon",10),l.Xc(7,"save"),l.gc(),l.Xc(8," Save All Brands "),l.gc(),l.gc()}}function b(t,c){if(1&t&&l.cc(0,"img",18),2&t){const t=l.tc().$implicit;l.Cc("src",t.image,l.Pc)}}function f(t,c){if(1&t){const t=l.ic();l.hc(0,"div",19),l.hc(1,"div",20),l.hc(2,"app-appicon",21),l.pc("actionEvent",(function(c){return l.Nc(t),l.tc(2).delete(c)})),l.gc(),l.gc(),l.hc(3,"div",20),l.hc(4,"app-appicon",22),l.pc("actionEvent",(function(){l.Nc(t);const c=l.tc().$implicit;return l.tc().save(c)})),l.gc(),l.gc(),l.gc()}2&t&&(l.Ob(2),l.Cc("color","accent")("icon","delete")("askquestion",!0)("icontext","Delete Brand")("isiconwithtext",!0),l.Ob(2),l.Cc("color","accent")("icon","save")("icontext","Save Brand")("isiconwithtext",!0))}function m(t,c){if(1&t&&(l.hc(0,"ion-col",13),l.hc(1,"ion-card"),l.Vc(2,b,1,1,"img",14),l.hc(3,"ion-item",15),l.hc(4,"ion-label",16),l.Xc(5),l.gc(),l.gc(),l.hc(6,"ion-card-content"),l.Xc(7),l.gc(),l.Vc(8,f,5,9,"div",17),l.gc(),l.gc()),2&t){const t=c.$implicit,e=l.tc();l.Ob(2),l.Cc("ngIf",t.imageuploaded),l.Ob(3),l.Zc(" ",t.title," "),l.Ob(2),l.Zc(" ",t.description," "),l.Ob(1),l.Cc("ngIf",e.ygen.isAdmin())}}const v=[{path:"",component:(()=>{class t{constructor(t,c,e,i,n,o,a,s){this.centerdb=t,this.ycat=c,this.toast=e,this.ydata=i,this.ygen=n,this.papa=o,this.yalert=a,this.photoUploadService=s,this.clearme=!0,this.productlimit=50,this.products=[],this.uploader=s.getUploader(),s.getUploader().clearQueue(),s.getUploader().cancelAll()}ngOnInit(){this.centerdb.currenttenant.subscribe(t=>{this.crudList=new s.p(s.P.getpath()+"/shop/brands",this.ydata.getDatabase(),!0,this.ygen.getUid()),this.crudList.getList().subscribe(t=>{this.productlimit=t.length})})}previewFile(t){t.srcElement&&t.srcElement.files&&t.srcElement.files[0]&&(t.srcElement.files[0].name.includes(".csv")?(this.toast.pop("success","Got the event & processing "+t.target.files.length+" file","Ok"),this.toast.pop("warn","Reading files","Processing"),this.papa.parse(t.srcElement.files[0],{complete:(t,c)=>{t.errors.forEach(c=>t.data.splice(c.row,1)),t.data.forEach(t=>{t.uploaded=this.giveflag(t.uploaded),t.active=this.giveflag(t.active),t.imageuploaded=this.giveflag(t.imageuploaded);try{t.$key=JSON.parse(t.$key)}catch(c){console.error(t.$key,c)}}),this.products=t.data.filter(t=>!t.uploaded)},delimiter:",",header:!0})):this.yalert.errordata("Only CSV files are allowed"))}giveflag(t){return!!t&&"true"==t.toLowerCase()}saveAllItems(){this.yalert.openSnackBar("Saving All Brands at once","Ok"),this.products.forEach(t=>{let c=t.$key;this.ygen.canAddProducts()?this.saveupdate(t,c):console.log("Products will not be added")}),this.clearAllItems()}saveItem(t){this.saveupdate(t,t.$key)}saveupdate(t,c){this.ycat.recievedBrandListKeyVal[c]?this.crudList.updateList(t):this.crudList.addtolist(t)}delete(t){this.products=this.products.filter(c=>c.$key!=t.$key),this.yalert.openSnackBar("Product deleted","Ok")}save(t){this.saveItem(t),this.products=this.products.filter(c=>c.$key!=t.$key),this.yalert.openSnackBar("Product saved","Ok")}clearAllItems(){this.products.length=0,this.clearme=!1,setTimeout(()=>{this.clearme=!0},500)}}return t.\u0275fac=function(c){return new(c||t)(l.bc(s.P),l.bc(s.O),l.bc(r.d),l.bc(s.Q),l.bc(s.T),l.bc(d.a),l.bc(s.a),l.bc(s.cb))},t.\u0275cmp=l.Vb({type:t,selectors:[["app-uploadbrands"]],decls:15,vars:6,consts:[[3,"color"],["slot","start"],["padding",""],[4,"ngIf"],["style","padding:5px",4,"ngIf"],[1,"productlist"],["class","dada",4,"ngFor","ngForOf"],["hidden","","type","file","ng2FileSelect","",3,"uploader","change"],["productsFileInput",""],[1,"mat-raised-button","mat-primary",3,"click"],["color","warm",1,"pointer"],[2,"padding","5px"],[1,"mat-raised-button","mat-secondary",3,"click"],[1,"dada"],["class","imageshow",3,"src",4,"ngIf"],["button",""],[1,"ion-text-wrap"],["class","bcontainer",4,"ngIf"],[1,"imageshow",3,"src"],[1,"bcontainer"],[1,"bitems"],[3,"color","icon","askquestion","icontext","isiconwithtext","actionEvent"],[3,"color","icon","icontext","isiconwithtext","actionEvent"]],template:function(t,c){1&t&&(l.hc(0,"ion-header"),l.hc(1,"ion-toolbar",0),l.hc(2,"ion-buttons",1),l.cc(3,"ion-back-button"),l.gc(),l.hc(4,"ion-title"),l.Xc(5,"Upload Product Brands"),l.gc(),l.gc(),l.gc(),l.hc(6,"ion-content",2),l.Vc(7,h,7,1,"div",3),l.Vc(8,g,9,0,"div",4),l.hc(9,"ion-item"),l.Xc(10),l.gc(),l.cc(11,"div",5),l.hc(12,"ion-grid"),l.hc(13,"ion-row"),l.Vc(14,m,9,4,"ion-col",6),l.gc(),l.gc(),l.gc()),2&t&&(l.Ob(1),l.Cc("color","warning"),l.Ob(6),l.Cc("ngIf",c.clearme),l.Ob(1),l.Cc("ngIf",c.products.length>0),l.Ob(2),l.ad(' You are using "',c.ygen.getSubscriptionType(),'" subscription; You can add max ',c.ygen.maxproductsCanAdded()," Brands; "),l.Ob(4),l.Cc("ngForOf",c.products))},directives:[o.y,o.hb,o.j,o.f,o.g,o.fb,o.s,i.m,o.D,o.x,o.R,i.l,p.a,u.a,o.r,o.k,o.J,o.l,s.f],styles:[".bbcontainer[_ngcontent-%COMP%]{width:100%}.bbcontainer[_ngcontent-%COMP%], .bcontainer[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}"]}),t})()}];let y=(()=>{class t{}return t.\u0275mod=l.Zb({type:t}),t.\u0275inj=l.Yb({factory:function(c){return new(c||t)},imports:[[a.n.forChild(v)],a.n]}),t})(),w=(()=>{class t{}return t.\u0275mod=l.Zb({type:t}),t.\u0275inj=l.Yb({factory:function(c){return new(c||t)},imports:[[i.c,n.j,o.ib,s.H,s.o,s.b,p.b,y]]}),t})()}}]);